-- Создание GUI
local ScreenGui = Instance.new("ScreenGui")
local KeyFrame = Instance.new("Frame")
local SwitchFrame = Instance.new("Frame")
local KeyBox = Instance.new("TextBox")
local VerifyButton = Instance.new("TextButton")
local CopyLinkButton = Instance.new("TextButton")
local CloseKeyFrameButton = Instance.new("TextButton")
local MinimizeKeyFrameButton = Instance.new("TextButton")
local CloseSwitchFrameButton = Instance.new("TextButton")
local MinimizeSwitchFrameButton = Instance.new("TextButton")
local SwitchButtons = {}
local DraggableAreaKeyFrame = Instance.new("Frame")
local DraggableAreaSwitchFrame = Instance.new("Frame")

local isMinimized = false -- Состояние свёрнутости всех окон

-- Настройка GUI
ScreenGui.Parent = game.CoreGui

-- Общий контейнер для всех окон
local MainFrame = Instance.new("Frame")
MainFrame.Parent = ScreenGui
MainFrame.Size = UDim2.new(1, 0, 1, 0)
MainFrame.BackgroundTransparency = 1

-- Окно проверки ключа
KeyFrame.Parent = MainFrame
KeyFrame.Size = UDim2.new(0, 300, 0, 150)
KeyFrame.Position = UDim2.new(0.5, -150, 0.5, -75)
KeyFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
KeyFrame.Active = true
KeyFrame.Draggable = true

DraggableAreaKeyFrame.Parent = KeyFrame
DraggableAreaKeyFrame.Size = UDim2.new(1, 0, 0, 20)
DraggableAreaKeyFrame.BackgroundColor3 = Color3.fromRGB(70, 70, 70)

KeyBox.Parent = KeyFrame
KeyBox.Size = UDim2.new(0, 200, 0, 50)
KeyBox.Position = UDim2.new(0.5, -100, 0, 30)
KeyBox.PlaceholderText = "Enter the key"
KeyBox.Text = ""
KeyBox.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
KeyBox.TextColor3 = Color3.fromRGB(255, 255, 255)

VerifyButton.Parent = KeyFrame
VerifyButton.Size = UDim2.new(0, 100, 0, 30)
VerifyButton.Position = UDim2.new(0.5, -110, 0, 90)
VerifyButton.Text = "Check"
VerifyButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
VerifyButton.TextColor3 = Color3.fromRGB(255, 255, 255)

CopyLinkButton.Parent = KeyFrame
CopyLinkButton.Size = UDim2.new(0, 100, 0, 30)
CopyLinkButton.Position = UDim2.new(0.5, 10, 0, 90)
CopyLinkButton.Text = "Get key"
CopyLinkButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
CopyLinkButton.TextColor3 = Color3.fromRGB(255, 255, 255)

MinimizeKeyFrameButton.Parent = DraggableAreaKeyFrame
MinimizeKeyFrameButton.Size = UDim2.new(0, 20, 0, 20)
MinimizeKeyFrameButton.Position = UDim2.new(1, -50, 0, 0)
MinimizeKeyFrameButton.Text = "-"
MinimizeKeyFrameButton.BackgroundColor3 = Color3.fromRGB(150, 150, 150)

CloseKeyFrameButton.Parent = DraggableAreaKeyFrame
CloseKeyFrameButton.Size = UDim2.new(0, 20, 0, 20)
CloseKeyFrameButton.Position = UDim2.new(1, -25, 0, 0)
CloseKeyFrameButton.Text = "X"
CloseKeyFrameButton.BackgroundColor3 = Color3.fromRGB(150, 150, 150)

-- Окно переключателей
SwitchFrame.Parent = MainFrame
SwitchFrame.Visible = false
SwitchFrame.Size = UDim2.new(0, 300, 0, 250)
SwitchFrame.Position = UDim2.new(0.5, -150, 0.5, -125)
SwitchFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
SwitchFrame.Active = true
SwitchFrame.Draggable = true

DraggableAreaSwitchFrame.Parent = SwitchFrame
DraggableAreaSwitchFrame.Size = UDim2.new(1, 0, 0, 20)
DraggableAreaSwitchFrame.BackgroundColor3 = Color3.fromRGB(70, 70, 70)

MinimizeSwitchFrameButton.Parent = DraggableAreaSwitchFrame
MinimizeSwitchFrameButton.Size = UDim2.new(0, 20, 0, 20)
MinimizeSwitchFrameButton.Position = UDim2.new(1, -50, 0, 0)
MinimizeSwitchFrameButton.Text = "-"
MinimizeSwitchFrameButton.BackgroundColor3 = Color3.fromRGB(150, 150, 150)

CloseSwitchFrameButton.Parent = DraggableAreaSwitchFrame
CloseSwitchFrameButton.Size = UDim2.new(0, 20, 0, 20)
CloseSwitchFrameButton.Position = UDim2.new(1, -25, 0, 0)
CloseSwitchFrameButton.Text = "X"
CloseSwitchFrameButton.BackgroundColor3 = Color3.fromRGB(150, 150, 150)

for i = 1, 5 do
    local SwitchButton = Instance.new("TextButton")
    local CheckBox = Instance.new("Frame")SwitchButton.Parent = SwitchFrame
    SwitchButton.Size = UDim2.new(0, 200, 0, 30)
    SwitchButton.Position = UDim2.new(0.5, -100, 0, 30 + (i - 1) * 40)
    SwitchButton.Text = "Переключатель " .. i
    SwitchButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
    SwitchButton.TextColor3 = Color3.fromRGB(255, 255, 255)

    CheckBox.Parent = SwitchButton
    CheckBox.Size = UDim2.new(0, 20, 0, 20)
    CheckBox.Position = UDim2.new(1, -30, 0.5, -10)
    CheckBox.BackgroundColor3 = Color3.fromRGB(150, 150, 150)

    SwitchButtons[i] = {Button = SwitchButton, Box = CheckBox}
end

-- Логика
local function toggleMinimize()
    isMinimized = not isMinimized
    MainFrame.Visible = not isMinimized
end

CopyLinkButton.MouseButton1Click:Connect(function()
    setclipboard("https://example.com/get-key")
end)

VerifyButton.MouseButton1Click:Connect(function()
    if KeyBox.Text == "12345" then
        KeyFrame.Visible = false
        SwitchFrame.Visible = true
    else
        KeyBox.Text = "Wrong key!"
    end
end)

CloseKeyFrameButton.MouseButton1Click:Connect(function()
    KeyFrame.Visible = false
end)

CloseSwitchFrameButton.MouseButton1Click:Connect(function()
    SwitchFrame.Visible = false
end)

for i, components in ipairs(SwitchButtons) do
    components.Button.MouseButton1Click:Connect(function()
        local box = components.Box
        -- Переключение состояния (включено/выключено)
        box.BackgroundColor3 = (box.BackgroundColor3 == Color3.fromRGB(150, 150, 150)) and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(150, 150, 150)

        if i == 1 then
            if box.BackgroundColor3 == Color3.fromRGB(0, 255, 0) then
                -- Включить ESP
                print("ESP включено для CurrenEntity")
                enableESP("CurrenEntity")
            else
                -- Выключить ESP
                print("ESP отключено для CurrenEntity")
                disableESP("CurrenEntity")
            end
        else
            print("Переключатель " .. i .. " активирован")
        end
    end)
end

-- Функция для включения ESP
function enableESP(groupName)
    local group = game.Workspace:FindFirstChild(groupName)
    if group then
        for _, entity in ipairs(group:GetChildren()) do
            if entity:IsA("Model") then
                -- ESP для MeshPart
                local meshPart = entity:FindFirstChildOfClass("MeshPart")
                if meshPart then
                    createESPBox(meshPart)
                end
                -- ESP для частей тела
                for _, partName in ipairs({"Torso", "RightArm", "RightLeg", "LeftArm", "LeftLeg", "Head"}) do
                    local part = entity:FindFirstChild(partName)
                    if part then
                        createESPBox(part)
                    end
                end
            end
        end
    else
        print("Группа " .. groupName .. " не найдена")
    end
end

-- Функция для отключения ESP
function disableESP(groupName)
    local group = game.Workspace:FindFirstChild(groupName)
    if group then
        for _, entity in ipairs(group:GetChildren()) do
            for _, descendant in ipairs(entity:GetDescendants()) do
                if descendant:IsA("BoxHandleAdornment") then
                    descendant:Destroy()
                end
            end
        end
    end
end

-- Функция создания ESP
function createESPBox(part)
    local espBox = Instance.new("BoxHandleAdornment")
    espBox.Size = part.Size
    espBox.Color3 = Color3.new(1, 0, 0) -- Цвет ESP (красный)
    espBox.AlwaysOnTop = true
    espBox.ZIndex = 0
    espBox.Adornee = part
    espBox.Parent = part
end
